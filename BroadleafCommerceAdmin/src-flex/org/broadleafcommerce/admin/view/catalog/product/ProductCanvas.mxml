<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:product="org.broadleafcommerce.admin.view.catalog.product.*"
	currentState="view"
	width="95%" xmlns:sku="org.broadleafcommerce.admin.view.catalog.sku.*">
	<mx:Script>
		<![CDATA[
			import org.broadleafcommerce.admin.control.events.catalog.product.EditProductEvent;
			import org.broadleafcommerce.admin.control.events.catalog.product.NewProductEvent;
			import org.broadleafcommerce.admin.model.AppModelLocator;
			import org.broadleafcommerce.admin.model.view.ProductModel;
			
			[Bindable]
			private var productModel:ProductModel = AppModelLocator.getInstance().productModel;
		
			private function handleNewProduct(event:Event):void{
				new NewProductEvent().dispatch();
			}
			
			private function handleNavigatorClick(event:MouseEvent):void{
				if(tabNavigator.selectedChild == productEditForm){
					productModel.viewState = ProductModel.STATE_VIEW_EDIT;
				}
				if(tabNavigator.selectedChild == productMediaForm){
					productModel.viewState = ProductModel.STATE_VIEW_MEDIA;
				}
				if(tabNavigator.selectedChild == productSkuForm){
					productModel.viewState = ProductModel.STATE_VIEW_SKUS;
				}
			}
			
		]]>
	</mx:Script>
	<mx:Binding
		source="productModel.viewState"
		destination="currentState"/>
	<mx:VBox 
		width="100%"
		height="100%"
		horizontalGap="20">
		<mx:VBox
			verticalGap="10">
			<mx:LinkButton
				id="newProductLinkButton"
				label="New Product"
				click="handleNewProduct(event)"/>
		</mx:VBox>
		<mx:Canvas
			id="workingAreaHBox"
			width="100%"
			height="500"
			borderStyle="solid"
			cornerRadius="4">
			<product:ProductsView id="productsView"  width="490" height="445"/>
			<mx:TabNavigator id="tabNavigator" x="498" y="10" width="740" height="436" click="handleNavigatorClick(event)">
				<product:ProductEditForm id="productEditForm" label="General" width="100%" height="100%" />
				<product:ProductMediaCanvas  id="productMediaForm" label="Media" width="100%" height="100%" />
				<sku:SkuCanvas id="productSkuForm" label="Skus" width="100%" height="100%"  />
			</mx:TabNavigator>
			
			
		</mx:Canvas>		
	</mx:VBox>
	<mx:states>
		<mx:State
			name="{ProductModel.STATE_VIEW_EDIT}">
			<mx:SetProperty target="{tabNavigator}" name="selectedChild" value="{productEditForm}" />
		</mx:State>
		<mx:State
			name="{ProductModel.STATE_VIEW_MEDIA}">
			<mx:SetProperty target="{tabNavigator}" name="selectedChild" value="{productMediaForm}" />
		</mx:State>
		<mx:State
			name="{ProductModel.STATE_VIEW_SKUS}">
			<mx:SetProperty target="{tabNavigator}" name="selectedChild" value="{productSkuForm}" />
		</mx:State>
	</mx:states>
</mx:Canvas>