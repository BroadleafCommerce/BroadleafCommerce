<?xml version="1.0" encoding="UTF-8"?>
<!--
  #%L
  BroadleafCommerce Framework
  %%
  Copyright (C) 2009 - 2013 Broadleaf Commerce
  %%
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  
        http://www.apache.org/licenses/LICENSE-2.0
  
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  #L%
  -->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop-3.2.xsd">

    <!--
        By default, Broadleaf defines the Payment Activity to execute an AUTHORIZE AND DEBIT for a CHECKOUT flow.
        The blPaymentWorkflow is invoked from the blPaymentServiceActivity in the blCheckoutWorkflow.
    -->

    <bean p:order="1000" id="blPaymentActivity" class="org.broadleafcommerce.core.payment.service.workflow.CompositeActivity">
        <property name="workflow" ref="blAuthorizeAndDebitWorkflow"/>
    </bean>
    <bean id="blPaymentWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.SimplePaymentProcessContextFactory"/>
        </property>
        <property name="activities">
            <list>
                <ref bean="blPaymentActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are the default payment modules registered with Broadleaf.
        You should override these payment modules with your own implementation class if you would like to integrate with
        a specific payment provider. Or, if you are using a payment integration module provided by Broadleaf, the module
        should override the appropriate bean with its implementation (defined in the module applicationContext)
        during the merge process.
    -->
    <bean id="blGiftCardModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blCreditCardModule" class="org.broadleafcommerce.core.payment.service.module.NullCreditCardPaymentModule"/>
    <bean id="blBankAccountModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blCheckPaymentModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blElectronicCheckPaymentModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blWirePaymentModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blMoneyOrderPaymentModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blCustomerCreditPaymentModule" class="org.broadleafcommerce.core.payment.service.module.DefaultModule"/>
    <bean id="blCODPaymentModule" class="org.broadleafcommerce.core.payment.service.module.AcceptAndPassthroughModule" scope="prototype">
        <property name="validPaymentInfoType" value="COD"/>
    </bean>

    <bean id="blGiftCardService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blGiftCardModule"/>
    </bean>
    <bean id="blCreditCardService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blCreditCardModule"/>
    </bean>
    <bean id="blBankAccountService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blBankAccountModule"/>
    </bean>
    <bean id="blCheckPaymentService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blCheckPaymentModule"/>
    </bean>
    <bean id="blElectronicCheckPaymentService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blElectronicCheckPaymentModule"/>
    </bean>
    <bean id="blWirePaymentService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blWirePaymentModule"/>
    </bean>
    <bean id="blMoneyOrderPaymentService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blMoneyOrderPaymentModule"/>
    </bean>
    <bean id="blCustomerCreditPaymentService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blCustomerCreditPaymentModule"/>
    </bean>
    <bean id="blCODPaymentService" class="org.broadleafcommerce.core.payment.service.PaymentServiceImpl">
        <property name="paymentModule" ref="blCODPaymentModule"/>
    </bean>

    <!--
        The PaymentModule interface defines common transaction methods that can be executed against a PaymentInfo on the order.
        The PaymentProcessContextFactory determines which of those methods to execute based on the PaymentInfoType defined
        for that workflow.

        For example:
        - AUTHORIZE
        - DEBIT
        - AUTHORIZEANDDEBIT
        - CREDIT
        - VOID
        - BALANCE
        - REVERSEAUTHORIZE
        - PARTIALPAYMENT
    -->

    <!--
        Below are predefined beans for an AUTHORIZE payment flow
    -->
    <bean id="blAuthorizeGiftCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeCustomerCreditRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="1000" id="blAuthorizeGiftCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blGiftCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeGiftCardRollbackHandler"/>
    </bean>
    <bean p:order="2000" id="blAuthorizeCustomerCreditPaymentActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCustomerCreditPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeCustomerCreditRollbackHandler"/>
    </bean>
    <bean p:order="3000" id="blAuthorizeCreditCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeCreditCardRollbackHandler"/>
    </bean>
    <bean id="blAuthorizeWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="AUTHORIZE"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blAuthorizeGiftCardActivity" />
                <ref bean="blAuthorizeCustomerCreditPaymentActivity" />
                <ref bean="blAuthorizeCreditCardActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are predefined beans for a DEBIT payment flow
    -->
    <bean id="blDebitGiftCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blDebitCustomerCreditRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blDebitCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="1000" id="blDebitGiftCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blGiftCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blDebitGiftCardRollbackHandler"/>
    </bean>
    <bean p:order="2000" id="blDebitCustomerCreditPaymentActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCustomerCreditPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blDebitCustomerCreditRollbackHandler"/>
    </bean>
    <bean p:order="3000" id="blDebitCreditCardActivity"  class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blDebitCreditCardRollbackHandler"/>
    </bean>
    <bean id="blDebitWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="DEBIT"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blDebitGiftCardActivity" />
                <ref bean="blDebitCustomerCreditPaymentActivity" />
                <ref bean="blDebitCreditCardActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are predefined beans for an AUTHORIZE AND DEBIT payment flow
        Note: leaving ordering the same for legacy users (removal because of AccountCredit and AccountPayment Payment types)
    -->
    <bean id="blAuthorizeAndDebitCustomerCreditRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitGiftCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitBankAccountRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitCheckRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitElectronicCheckRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitWireRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitMoneyOrderRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blAuthorizeAndDebitCODRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="2000" id="blAuthorizeAndDebitCustomerCreditActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCustomerCreditPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitCustomerCreditRollbackHandler"/>
    </bean>
    <bean p:order="4000" id="blAuthorizeAndDebitGiftCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blGiftCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitGiftCardRollbackHandler"/>
    </bean>
    <bean p:order="5000" id="blAuthorizeAndDebitCreditCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitCreditCardRollbackHandler"/>
    </bean>
    <bean p:order="6000" id="blAuthorizeAndDebitBankAccountActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blBankAccountService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitBankAccountRollbackHandler"/>
    </bean>
    <bean p:order="7000" id="blAuthorizeAndDebitCheckActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCheckPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitCheckRollbackHandler"/>
    </bean>
    <bean p:order="8000" id="blAuthorizeAndDebitElectronicCheckActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blElectronicCheckPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitElectronicCheckRollbackHandler"/>
    </bean>
    <bean p:order="9000" id="blAuthorizeAndDebitWireActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blWirePaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitWireRollbackHandler"/>
    </bean>
    <bean p:order="10000" id="blAuthorizeAndDebitMoneyOrderActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blMoneyOrderPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitMoneyOrderRollbackHandler"/>
    </bean>
    <bean p:order="11000" id="blAuthorizeAndDebitCODActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCODPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blAuthorizeAndDebitCODRollbackHandler"/>
    </bean>
    <bean id="blAuthorizeAndDebitWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="AUTHORIZEANDDEBIT"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blAuthorizeAndDebitCustomerCreditActivity" />
                <ref bean="blAuthorizeAndDebitGiftCardActivity" />
                <ref bean="blAuthorizeAndDebitCreditCardActivity" />
                <ref bean="blAuthorizeAndDebitBankAccountActivity" />
                <ref bean="blAuthorizeAndDebitCheckActivity" />
                <ref bean="blAuthorizeAndDebitElectronicCheckActivity" />
                <ref bean="blAuthorizeAndDebitWireActivity" />
                <ref bean="blAuthorizeAndDebitMoneyOrderActivity" />
                <ref bean="blAuthorizeAndDebitCODActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are predefined beans for a CREDIT payment flow
    -->
    <bean id="blCreditCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blCreditGiftCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blCreditCustomerCreditRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="1000" id="blCreditCreditCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blCreditCreditCardRollbackHandler"/>
    </bean>
    <bean p:order="2000" id="blCreditGiftCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blGiftCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blCreditGiftCardRollbackHandler"/>
    </bean>
    <bean p:order="3000" id="blCreditCustomerCreditActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCustomerCreditPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blCreditCustomerCreditRollbackHandler"/>
    </bean>
    <bean id="blCreditWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="CREDIT"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blCreditCreditCardActivity" />
                <ref bean="blCreditGiftCardActivity" />
                <ref bean="blCreditCustomerCreditActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are predefined beans for a VOID payment flow
    -->
    <bean id="blVoidCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blVoidGiftCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blVoidCustomerCreditRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="1000" id="blVoidCreditCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blVoidCreditCardRollbackHandler"/>
    </bean>
    <bean p:order="2000" id="blVoidGiftCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blGiftCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blVoidGiftCardRollbackHandler"/>
    </bean>
    <bean p:order="3000" id="blVoidCustomerCreditPaymentActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCustomerCreditPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blVoidCustomerCreditRollbackHandler"/>
    </bean>
    <bean id="blVoidWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="VOID"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blVoidCreditCardActivity" />
                <ref bean="blVoidGiftCardActivity" />
                <ref bean="blVoidCustomerCreditPaymentActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are predefined beans for a REVERSEAUTHORIZE payment flow
    -->
    <bean id="blReverseAuthCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blReverseAuthGiftCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>
    <bean id="blReverseAuthCustomerCreditRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="1000" id="blReverseAuthCreditCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blReverseAuthCreditCardRollbackHandler"/>
    </bean>
    <bean p:order="2000" id="blReverseAuthGiftCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blGiftCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blReverseAuthGiftCardRollbackHandler"/>
    </bean>
    <bean p:order="3000" id="blReverseAuthCustomerCreditPaymentActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCustomerCreditPaymentService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blReverseAuthCustomerCreditRollbackHandler"/>
    </bean>
    <bean id="blReverseAuthWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="REVERSEAUTHORIZE"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blReverseAuthCreditCardActivity" />
                <ref bean="blReverseAuthGiftCardActivity" />
                <ref bean="blReverseAuthCustomerCreditPaymentActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>

    <!--
        Below are predefined beans for a PARTIALPAYMENT payment flow
    -->
    <bean id="blPartialPaymentCreditCardRollbackHandler" class="org.broadleafcommerce.core.workflow.state.NullCheckoutRollbackHandler"/>

    <bean p:order="1000" id="blPartialPaymentCreditCardActivity" class="org.broadleafcommerce.core.payment.service.workflow.PaymentActivity">
        <property name="paymentService" ref="blCreditCardService"/>
        <property name="userName" value="web"/>
        <property name="rollbackHandler" ref="blPartialPaymentCreditCardRollbackHandler"/>
    </bean>
    <bean id="blPartialPaymentWorkflow" class="org.broadleafcommerce.core.workflow.SequenceProcessor">
        <property name="processContextFactory">
            <bean class="org.broadleafcommerce.core.payment.service.workflow.PaymentProcessContextFactory">
                <property name="paymentActionType" value="PARTIALPAYMENT"/>
            </bean>
        </property>
        <property name="activities">
            <list>
                <ref bean="blPartialPaymentCreditCardActivity" />
            </list>
        </property>
        <property name="defaultErrorHandler" ref="blDefaultErrorHandler"/>
    </bean>
    
</beans>